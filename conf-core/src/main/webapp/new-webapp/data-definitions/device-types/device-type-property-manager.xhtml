<ui:composition template="../../template/template.xhtml" 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui">
    <ui:define name="content">
	      <h:panelGroup id="deviceTypePropertiesManagerContainer" layout="block" class="container">
	           <p:growl showDetail="true" globalOnly="true" />
	           <h:form id="deviceTypePropertiesManagerForm" enctype="multipart/form-data">
		           <h:panelGroup class="properties-parent-info" layout="block">
		               <h:panelGrid columns="2" style="width: 100%; text-align: top;" border="0">  
		                   
		                   <h:outputLabel style="font-size: 12px" value="Device type name:" />
		                   <h:outputText style="font-size: 12px" value="#{comptypeAttributesController.deviceType.name}" />
	                   		                   		                   
		                   <h:outputLabel style="font-size: 12px" value="Description:" />
	                       <p:inputTextarea value="#{comptypeAttributesController.deviceType.description}"  rows="5" readonly="true" style="width: 100%; font-size: 12px"/>
	                   </h:panelGrid>
	               </h:panelGroup>
		           
		           <h:panelGroup class="property-values" layout="block">
		              <p:commandButton id="addButton" value="Add" type="button" icon="ui-icon-plus"/>
                      <p:menu overlay="true" trigger="addButton" my="left top" at="left bottom">
                            <p:menuitem value="Type Property" oncomplete="addDeviceTypeProperty.show()" actionListener="#{comptypeAttributesController.prepareForPropertyValueAdd}" update=":addDeviceTypePropertyForm:addDeviceTypeProperty"/>
                            <p:menuitem value="Property Definition" oncomplete="deviceTypePropertyDefinition.show()" actionListener="#{comptypeAttributesController.prepareForPropertyValueAdd}" update=":deviceTypePropertyDefinitionForm:deviceTypePropertyDefinition"/>
                            <p:menuitem value="Tag" oncomplete="deviceTypeTag.show()" actionListener="#{comptypeAttributesController.prepareForPropertyValueAdd}"/>
                            <p:menuitem value="Artifact" oncomplete="deviceTypeArtifact.show()" actionListener="#{comptypeAttributesController.prepareForArtifactAdd}" update=":deviceTypeArtifactForm:deviceTypeArtifact"/>
		               </p:menu>
		               <p:dataTable id="attributesDataTable" var="attribute" value="#{comptypeAttributesController.attributes}" rows="15" paginator="true" paginatorPosition="bottom">
			                <p:column headerText="Name" sortBy="#{attribute.name}">
			                    <h:outputText value="#{attribute.name}" />
			                </p:column>
			    
			                <p:column headerText="Type">
			                    <h:outputText value="#{attribute.type.name}" />
			                </p:column>
			                
			                <p:column headerText="Kind">
			                    <h:outputText value="#{attribute.kind}" />
			                </p:column>
			                
			                <p:column headerText="Unit" >
			                    <h:outputText value="#{attribute.unit.name}" />
			                </p:column>
			    
			                <p:column headerText="Actions">
			                    <p:commandButton icon="ui-icon-trash" title="Delete" ajax="true" oncomplete="deleteAttribute.show()">
			                         <f:setPropertyActionListener value="#{attribute}" target="#{comptypeAttributesController.selectedAttribute}" />
			                    </p:commandButton>
			                    <p:commandButton icon="ui-icon-pencil" title="Edit" ajax="true" rendered="#{attribute.kind != 'Definition'}" />
			                    <p:commandButton icon="ui-icon-arrowthick-1-s" title="Download" ajax="false" rendered="#{attribute.hasFile}">
			                         <f:setPropertyActionListener value="#{attribute}" target="#{comptypeAttributesController.selectedAttribute}" />
			                         <p:fileDownload value="#{comptypeAttributesController.downloadFile}" />
			                    </p:commandButton>
			                    <p:button icon="ui-icon-extlink" target="_blank" title="Got to URL" ajax="true" rendered="#{attribute.hasURL}" href="#{attribute.value}"/>
			                </p:column>
	                    </p:dataTable>
	               </h:panelGroup>
                </h:form>
        </h:panelGroup>
        
        <ui:include src="../add-or-modify-dialogs/delete-confirmation.xhtml" >
            <ui:param name="formId" value="deleteAttributeForm" />
            <ui:param name="dialogTitle" value="Delete attribute" />
            <ui:param name="widgetName" value="deleteAttribute" />
            <ui:param name="controller" value="#{comptypeAttributesController}" />
            <ui:param name="submitHandler" value="deleteAttribute" />
            <ui:param name="formToUpdate" value=":deviceTypePropertiesManagerContainer" />
        </ui:include>
            
        <ui:include src="../add-or-modify-dialogs/property-value.xhtml" >
            <ui:param name="formId" value="addDeviceTypePropertyForm" />
            <ui:param name="dialogTitle" value="Add new device type property" />
            <ui:param name="widgetName" value="addDeviceTypeProperty" />
            <ui:param name="controller" value="#{comptypeAttributesController}" />
            <ui:param name="submitHandler" value="addNewPropertyValue" />
        </ui:include>
        
        <ui:include src="../add-or-modify-dialogs/property-value.xhtml" >
            <ui:param name="formId" value="modifyDeviceTypePropertyForm" />
            <ui:param name="dialogTitle" value="Modify device type property" />
            <ui:param name="widgetName" value="modifyDeviceTypeProperty" />
            <ui:param name="controller" value="#{comptypeAttributesController}" />
            <ui:param name="submitHandler" value="modifyPropertyValue" />
        </ui:include>
        
        <ui:include src="../add-or-modify-dialogs/property-definition.xhtml" >
            <ui:param name="formId" value="deviceTypePropertyDefinitionForm" />
            <ui:param name="dialogTitle" value="Add new device type property definition" />
            <ui:param name="widgetName" value="deviceTypePropertyDefinition" />
            <ui:param name="controller" value="#{comptypeAttributesController}" />
            <ui:param name="submitHandler" value="addNewPropertyValue" />
        </ui:include>
        
        <ui:include src="../add-or-modify-dialogs/tag.xhtml" >
            <ui:param name="formId" value="deviceTypeTagForm" />
            <ui:param name="dialogTitle" value="Add new device type tag" />
            <ui:param name="widgetName" value="deviceTypeTag" />
            <ui:param name="controller" value="#{comptypeAttributesController}" />
            <ui:param name="submitHandler" value="addNewTag" />
        </ui:include>
        
        <ui:include src="../add-or-modify-dialogs/artifact.xhtml" >
            <ui:param name="formId" value="deviceTypeArtifactForm" />
            <ui:param name="dialogTitle" value="Add new device type artifact" />
            <ui:param name="widgetName" value="deviceTypeArtifact" />
            <ui:param name="controller" value="#{comptypeAttributesController}" />
            <ui:param name="submitHandler" value="addNewArtifact" />
        </ui:include>   
    </ui:define>
</ui:composition>