<ui:composition template="/template/template.xhtml" 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui">

    <ui:define name="content">
        <h:form id="enumsForm">
            <p:dataTable widgetVar="enumsTableVar" var="enum" id="enumsTable" value="#{dataTypeManager.dataTypeViews}" 
                    selection="#{dataTypeManager.selectedEnum}" selectionMode="single" rowKey="#{enum.enumeration.id}" 
                    resizableColumns="true" style="table-layout: fixed; word-wrap: break-word;" 
                    filteredValue="#{dataTypeManager.filteredDataTypeViews}" rows="15" paginator="true" 
                    paginatorPosition="bottom">
                <p:ajax event="filter" ignoreAutoUpdate="true"/>
                <p:ajax event="rowSelect" update=":enumsForm:deleteButton :enumsForm:editButton" />
                <p:ajax event="rowUnselect" update=":enumsForm:deleteButton :enumsForm:editButton" />

                <p:column headerText="Name" sortBy="#{enum.name}" filterBy="#{enum.name}" width="10%" 
                        filterMatchMode="contains" filterStyle="width: 90%;">
                    <h:outputText value="#{enum.name}" />
                </p:column>

                <p:column headerText="Description" sortBy="#{enum.description}" filterBy="#{enum.description}" 
                        width="30%" filterStyle="width: 20em;" filterMatchMode="contains">
                    <h:outputText value="#{enum.description}" />
                </p:column>

                <p:column headerText="Definition" sortBy="#{enum.definitionAsString}" 
                        filterBy="#{enum.definitionAsString}" filterMatchMode="contains">
                    <h:outputText value="#{enum.definitionAsString}" width="50%"/>
                </p:column>
            </p:dataTable>
            <p:commandButton id="exportButton" icon="ui-icon-disk" value="Export" title="Export" 
                style="float: right; margin-top: 1em;" oncomplete="PF('exportEnums').show();" 
                disabled="#{empty dataTypeManager.dataTypeViews}" update=":exportEnumsForm:exportEnums" 
                actionListener="#{dataTypeManager.prepareTableExportPopup}" />
            <p:commandButton id="deleteButton" icon="ui-icon-trash" value="Delete" title="Delete" 
                style="float: right; margin: 1em 1ex 0 0;" oncomplete="PF('deleteEnum').show();" 
                disabled="#{empty dataTypeManager.selectedEnum or dataTypeManager.selectedEnumUsed}" />
            <p:commandButton id="editButton" icon="ui-icon-pencil" value="Edit" title="Edit" 
                style="float: right; margin: 1em 1ex 0 0;" update=":modifyEnumForm:modifyEnum" 
                disabled="#{empty dataTypeManager.selectedEnum}" oncomplete="PF('modifyEnum').show();" 
                actionListener="#{dataTypeManager.prepareModifyPopup}" />
            <p:commandButton ajax="true" actionListener="#{dataTypeManager.prepareAddPopup}" value="Add"
                    title="Add new enumeration" icon="ui-icon-plus" style="float: right; margin: 1em 1ex 0 0;" 
                    oncomplete="PF('addEnum').show();" update=":addEnumForm:addEnum" />
        </h:form>

        <ui:include src="/resources/dialogs/delete-confirmation.xhtml" >
            <ui:param name="formId" value="deleteEnumForm" />
            <ui:param name="dialogTitle" value="Delete enumeration" />
            <ui:param name="widgetName" value="deleteEnum" />
            <ui:param name="controller" value="#{dataTypeManager}" />
            <ui:param name="submitHandler" value="onDelete" />
            <ui:param name="formToUpdate" value=":enumsForm:enumsTable :enumsForm:deleteButton 
                                                :enumsForm:editButton :enumsForm:exportButton" />
            <ui:param name="resetFilter" value="PF('enumsTableVar').filter();" />
            <ui:param name="entityType" value="this enumeration" />
        </ui:include>

        <ui:include src="/resources/dialogs/add-or-modify-enum.xhtml">
            <ui:param name="formId" value="modifyEnumForm" />
            <ui:param name="dialogTitle" value="Modify enumeration" />
            <ui:param name="widgetName" value="modifyEnum" />
            <ui:param name="submitHandler" value="onModify" />
            <ui:param name="componentToUpdate" value=":enumsForm:enumsTable :enumsForm:deleteButton :enumsForm:editButton" />
        </ui:include>

        <ui:include src="/resources/dialogs/add-or-modify-enum.xhtml">
            <ui:param name="formId" value="addEnumForm" />
            <ui:param name="dialogTitle" value="Add Enumeration" />
            <ui:param name="widgetName" value="addEnum" />
            <ui:param name="submitHandler" value="onAdd" />
            <ui:param name="componentToUpdate" value=":enumsForm:enumsTable :enumsForm:deleteButton 
                                                :enumsForm:editButton :enumsForm:exportButton" />
        </ui:include>

        <ui:include src="/resources/dialogs/export-table.xhtml">
            <ui:param name="formId" value="exportEnumsForm" />
            <ui:param name="widgetName" value="exportEnums" />
            <ui:param name="dialogTitle" value="Export enumerations table" />
            <ui:param name="fileFormatSelection" value="#{dataTypeManager.fileFormat}" />
            <ui:param name="includeHeader" value="#{dataTypeManager.includeHeaderRow}" />
            <ui:param name="tableFile" value="#{dataTypeManager.exportedTable}" />
        </ui:include>
    </ui:define>
</ui:composition>