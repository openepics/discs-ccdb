<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html">

    <h:form id="#{formId}">
        <p:dialog id="#{widgetName}" widgetVar="#{widgetName}" modal="true" resizable="false" closable="false" 
            width="45em" dynamic="true">
            <f:facet name="header">
                <h:outputText value="Slot relationships" />
            </f:facet>

            <p:panelGrid id="grp" styleClass="dialog-grid-panel noBorders">
                <p:row>
                    <p:column style="text-align: letf">
                        <p:commandButton value="Add relationship" oncomplete="PF('addSlotRelationship').show()" 
                            update=":addSlotRelationshipForm" actionListener="#{hierarchiesController.prepareAddRelationshipPopup}" />
                    </p:column>
                    <p:column style="text-align: letf">
                        <p:commandButton id="deleteRelationship" value="Delete relationship" 
                            disabled="#{empty hierarchiesController.selectedRelationship}" 
                            action="#{hierarchiesController.onRelationshipDelete}" update=":#{formId}:relationshipTable"/>
                    </p:column>
                </p:row>
                <p:row>
                    <p:column colspan="2">
                        <p:dataTable value="#{hierarchiesController.relationships}" id="relationshipTable" 
                            var="relationship" selectionMode="single" rowKey="#{relationship.slotPair.id}" 
                            selection="#{hierarchiesController.selectedRelationship}" paginator="false" 
                            scrollable="true" scrollHeight="200">
                            <p:ajax event="rowSelect" update=":#{formId}:deleteRelationship" />
                            <p:ajax event="rowUnselect" update=":#{formId}:deleteRelationship" />

                            <p:column headerText="Relationship" width="50%">
                                <h:outputText value="#{relationship.relationshipName}" />
                            </p:column>
                            <p:column headerText="Target" width="50%">
                                <h:outputText value="#{relationship.targetSlotName}" />
                            </p:column>
                        </p:dataTable>   
                    </p:column>
                </p:row>
			</p:panelGrid>

			<p:commandButton value="Close" styleClass="dialogButton" onclick="PF('#{widgetName}').hide();" 
                    action="#{hierarchiesController.onRelationshipPopupClose}" update=":hierarchies" 
                    oncomplete="hierarchiesResizeAll();setRightColumnWidths();"/>
		</p:dialog>
	</h:form>

	<ui:include src="cannot-delete-relationship.xhtml" />
	<ui:include src="slot-pair-loop-notification.xhtml" />
	<ui:include src="add-relationship.xhtml" />

</ui:composition>