<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html">

    <h:form id="#{formId}">
        <p:dialog widgetVar="#{widgetName}" id="#{widgetName}" width="900" modal="true" resizable="false" closable="false" dynamic="true">
            <f:facet name="header">
                <h:outputText value="#{dialogTitle}" />
            </f:facet>
             <p:dataTable var="auditRecord" id="auditLogTable" value="#{auditManager.auditRecordsForEntity}" style="table-layout: fixed; word-wrap: break-word;margin-bottom: 1em;" resizableColumns="true" paginator="false" scrollable="true" scrollHeight="300">
                <p:column headerText="Entity Name">
                    <h:outputText value="#{auditRecord.entityKey}" />
                </p:column>
                
                <p:column headerText="Operation">
                    <h:outputText value="#{auditRecord.oper}" />
                </p:column>

                <p:column headerText="User">
                    <h:outputText value="#{auditRecord.user}" />
                </p:column>
                
                <p:column headerText="Timestamp">
                    <h:outputText value="#{auditRecord.logTime}">
                        <f:convertDateTime pattern="yyyy-MM-dd HH:mm:ss.sss"/>
                    </h:outputText>
                </p:column>
                
                <p:column headerText="Entity Type">
                    <h:outputText value="#{auditRecord.entityType}" />
                </p:column>
                
                <p:column headerText="Change">
                    <h:outputText value="#{auditRecord.entry.length() lt 46 ? auditRecord.entry : auditRecord.entry.substring(0,45) += '...'}" />
                </p:column>
                
                <p:column headerText="Action" width="50" style="text-align: center;" >
                    <p:commandLink ajax="true" title="Details" update=":logDetailsForm" oncomplete="logDetails.show()" 
                            action="#{auditManager.chooseDisplayRecord(auditRecord.id)}">
                        <h:outputText styleClass="ui-icon ui-icon-info" style="display: inline-block !important; margin-right: 6px;" />
                    </p:commandLink>
                </p:column>
            </p:dataTable>
            <p:commandButton value="Close" styleClass="rightmostDialogButton" onclick="#{widgetName}.hide();" />
        </p:dialog>
    </h:form>
</ui:composition>