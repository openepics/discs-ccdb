<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:fc="http://java.sun.com/jsf/composite/comps"
	xmlns:h="http://java.sun.com/jsf/html">

	<h:form id="menuform">
		<p:growl id="menumsgs" showDetail="true"/>

		<p:menubar id="mainMenu" styleClass="menubar">
			<p:menuitem value="Home" icon="ui-icon-home" title="Home" url="/" />

			<p:submenu label="Browse" icon="ui-icon-note" rendered="true">
				<p:menuitem value="Alignments" title="Browse Alignment Records"
					url="/browse/alignment/" icon="ui-icon-note" />
				<p:menuitem value="Component Types" title="Browse Component Types"
					url="/browse/comptype/" icon="ui-icon-note" />
				<p:menuitem value="Data Types" title="Browse Data Types"
					url="/browse/datatype/" icon="ui-icon-note" />
				<p:menuitem value="Devices" icon="ui-icon-note"
					title="Browse Devices" url="/browse/device/" />
				<p:menuitem value="Installations" title="Browse Installations"
					url="/browse/installation/" icon="ui-icon-note" />
				<p:menuitem value="Properties" title="Browse Properties"
					url="/browse/property/" icon="ui-icon-note" />
				<p:menuitem value="Slots" icon="ui-icon-note" title="Browse Slots"
					url="/browse/slot/" />
				<p:menuitem value="Units" title="Browse Units" url="/browse/unit/"
					icon="ui-icon-note" />
			</p:submenu>
			<p:submenu label="Export" icon="ui-icon-transferthick-e-w">
				<p:menuitem value="Lattice" title="Export Layout"
					url="/export/lattice.xhtml" icon="ui-icon-transfer-e-w" />
			</p:submenu>
			<p:submenu label="Manage" icon="ui-icon-newwin">
				<p:menuitem value="Alignments" title="Edit Alignment Records"
					url="/manage/alignment/" icon="ui-icon-newwin"
					disabled="#{! loginManager.authorized}" />
				<p:menuitem value="Component Types" title="Edit Component Types"
					url="/manage/comptype/" icon="ui-icon-newwin"
					disabled="#{! loginManager.authorized}" />
				<p:menuitem value="Data Types" title="Edit Data Types"
					url="/manage/property/" icon="ui-icon-newwin" disabled="true" />
				<p:menuitem value="Devices" title="Device Assemblies"
					url="/manage/device/" icon="ui-icon-newwin"
					disabled="#{! loginManager.authorized}" />
				<p:menuitem value="Installations" title="Edit Installation Records"
					url="/manage/installation/" icon="ui-icon-newwin"
					disabled="#{! loginManager.authorized}" />
				<p:menuitem value="Propeties" title="Edit Properties"
					url="/manage/property/" icon="ui-icon-newwin"
					disabled="#{! loginManager.authorized}" />
				<p:menuitem value="Slots" title="Edit Layout Slots"
					url="/manage/slot/" icon="ui-icon-newwin"
					disabled="#{! loginManager.authorized}" />
				<p:menuitem value="Units" title="Edit Units" url="/manage/property/"
					icon="ui-icon-newwin" disabled="true" />
			</p:submenu>

			<p:menuitem value="Reports" title="Reports" icon="ui-icon-print"
				url="reports.xhtml" disabled="true" />

			<p:menuitem value="Preferences" title="Preferences"
				icon="ui-icon-gear" url="preferences.xhtml" disabled="true" />
			<p:submenu label="Admin" icon="ui-icon-note" rendered="true">

				<p:menuitem value="Audit Records" title="Browse Audit Records"
					url="/browse/audit/" icon="ui-icon-note" />
				<p:menuitem value="Authorization" title="Manage Authorizations"
					url="/browse/audit/" icon="ui-icon-note" disabled="true" />
			</p:submenu>

			<p:submenu label="Import" icon="ui-icon-folder-open" rendered="true">
                <p:menuitem value="Import Units" update=":importUnitsForm"
                    oncomplete="importUnits.show()" title="Import Units"
                    actionListener="#{unitManager.prepareImportPopup()}"
                    disabled="#{!unitManager.canImportUnits()}" />
            </p:submenu>

			<p:submenu label="Help" icon="ui-icon-help">
				<p:menuitem value=" Online Help" title="Online Help"
					icon="ui-icon-help" url="help.xhtml" disabled="true" />
				<p:menuitem value=" API Manual" title="API Manual"
					icon="ui-icon-script" url="api-manual.xhtml" disabled="true" />
				<p:menuitem value=" Report Problems"
					title="Report Problems/Suggestions" icon="ui-icon-alert"
					target="_blank" url="#{msgs.bugReportSite}" rendered="true" />
				<p:menuitem value=" About" id="aboutMenu" icon="ui-icon-info"
					title="About #{msgs.title}" onclick="aboutPanelWid.show()" />
			</p:submenu>

			<f:facet name="options">
				<fc:logincomp ajax="false" />
			</f:facet>
		</p:menubar>
		<p:dialog id="aboutPanel" header="#{msgs.title}"
			widgetVar="aboutPanelWid">
			<ui:include src="about.xhtml" />
		</p:dialog>
		
	</h:form>

	

	<h:form id="importUnitsForm" enctype="multipart/form-data">            
            <p:dialog id="importUnits" widgetVar="importUnits" modal="true" resizable="false" width="35%">              
                <f:facet name="header">
                    <h:outputText value="Units Import" />
                </f:facet>
                <h:panelGroup id="grp" layout="block">
                    <h:panelGroup rendered="#{unitManager.importFileName == null}" layout="block" style="padding: 0 0 7px 0">Please choose an Excel file (*.xlsx) to import units from.</h:panelGroup>
                    <p:fileUpload fileUploadListener="#{unitManager.handleFileUpload}" update="grp" mode="advanced" auto="true" fileLimit="1" dragDropSupport="true" allowTypes="/(\.|\/)(xlsx)$/" rendered="#{unitManager.importFileName == null}" />
                    <h:outputText value="#{unitManager.importFileName}"/>
                    <p:separator />
                    <p:commandButton value="Cancel" style="float: right" onclick="importUnits.hide();"/>
                    <p:commandButton value="Import" style="float: right" update=":menuform" oncomplete="importUnits.hide()" action="#{unitManager.importUnits()}" disabled="#{unitManager.importFileName == null}"/>
                </h:panelGroup>
            </p:dialog>
        </h:form>
</ui:composition>
